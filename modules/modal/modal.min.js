define(["jquery"],function(){return(function(b){var a=function(c,d){this.$el=b(d);this.options=b.extend({},a.DEFAULTS,c);this.inti()};a.DEFAULTS={bgClose:true,target:null,onShow:null,onClose:null,onDestroy:null,content:null};a.prototype.STATICS={template:'<div class="modal"><div class="modalContainer"><div class="modalHeader"><span class="btnClose" title="关闭"><i class="icon-closeelement"></i> </span></div><div class="modalBody"></div> </div> </div>'};a.prototype.inti=function(){this.$model=this.model();if(this.$el.length){this.$el.off("click.md").on("click.md",b.proxy(this.show,this))}var c=this;this.$model.find(".btnClose").on("click",b.proxy(this.hide,this));b(document).on("keyup",function(d){if(d.keyCode===27){c.hide()}});if(this.options.bgClose){c.$model.on("click",function(d){if(d.target===c.$model[0]){c.hide()}})}};a.prototype.model=function(){if(this.$model){return this.$model}else{if(this.options.target){return b(this.options.target)}else{return b(this.STATICS.template).find(".modalBody").append(this.options.content).parents(".modal").appendTo("body")}}};a.prototype.show=function(){if(typeof this.options.onShow==="function"){this.options.onShow()}this.$model.addClass("open")};a.prototype.hide=function(){if(typeof this.options.onClose==="function"){this.options.onClose()}this.$model.removeClass("open")};a.prototype.destroy=function(){if(typeof this.options.onDestroy==="function"){this.options.onDestroy()}this.$model.remove();this.$el.off("click.md")};b.fn.mdModel=function(c){return this.each(function(){new a(c,this)})};b.fn.mdModel.show=function(c){return new a(c).show()};b.fn.mdModel.destroyAll=function(){b(".mdModel").remove()};b("[data-toggle='model']").each(function(){var c=b(this).attr("href")||b(this).data("target");new a({target:c},this)});b.fn.mdModel.Constructor=a;return a})(jQuery)});